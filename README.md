# ex2AI2 — בקר MDP ללוח לחץ (Pressure Plate)

תיאור קצר של המטלה: מימוש בקר/מדיניות (Policy) לסביבת **Pressure Plate** סטוכסטית. אתם מממשים את הלוגיקה ב־`ex2.py`, מריצים בדיקות בעזרת `check.py`, ומגישים רק את הקבצים הנדרשים לפי ההנחיות.

---

## 📦 מבנה הריפו

```
ex2AI2/
├─ ex2.py               # כאן מממשים את הבקר (Controller) — הקובץ להגשה
├─ check.py             # סקריפט בדיקה והרצה עם דוגמאות
└─ pressure_plate.py    # מחלקת הסביבה / המשחק (מנוע)
```

**הגשה (כפי שמופיע במסמך המטלה):**
- מגישים **רק** `ex2.py` ו־`details.txt` (שם באנגלית בשורה 1, ת"ז בשורה 2).
- זמנים ולוגיסטיקה — לפי מסמך המטלה.

---

## 🎯 מה עושים כאן?

עליכם לכתוב **בקר** שמקבל מצב ומחזיר פעולה אחת מהסט: `"U" | "L" | "R" | "D"`.  
הסביבה סטוכסטית — ייתכנו "החלקות" שבהן הפעולה שבוצעה בפועל שונה מזו שבחרתם.

---

## 🧠 מה לממש ב־`ex2.py`

מממשים את המחלקה `Controller` עם שתי חתימות **בדיוק**:

1. `__init__(self, original_game)` — אתחול, מותר לבצע חישובים מקדימים/למידה מראש.
2. `choose_next_action(self, state) -> str` — מקבל מצב ומחזיר פעולה אחת (`"U"/"L"/"R"/"D"`).

> אין לשנות שמות/חתימות. מותר להוסיף פונקציות עזר פנימיות.

**מבנה מצב (בקירוב):**  
`(game_map, agent_pos_tuple, steps_taken, is_finished, is_success)`

---

## 🧩 מודל הסביבה (על קצה המזלג)

- `chosen_action_prob`: מיפוי פעולה-נבחרת → רשימת הסתברויות באותו סדר `["U","L","R","D"]` לפעולה שתבוצע בפועל.
- `finished_reward`: תגמול סיום בהגעה ליעד.
- `opening_door_reward`: מיפוי סוג מפתח → תגמול לפתיחת דלתות.
- `step_punishment`: קנס לצעד בעת סיום המשחק.
- `seed`: זרע לאקראיות.
- `max_steps`: מקס' צעדים לפתרון.
- `map`: מפת פתיחה.
- `debug`: הדפסות דיבוג להרצה.

---

## 🚀 התקנה והרצה

1) **שכפול והכנה**
```bash
git clone https://github.com/<USER>/ex2AI2.git
cd ex2AI2
```

2) **(אופציונלי) סביבת עבודה**
```bash
python -m venv .venv
source .venv/bin/activate   # Windows: .venv\Scripts\activate
```

3) **הרצת בדיקות דוגמה**
```bash
python check.py
```

ניתן להוסיף בעזרתכם עוד תרחישים/מודלים בתוך `check.py` לצורך בדיקות חזקות יותר.

---

## 🛡️ כללים והגבלות שימוש

- מותר לגשת ל־API של `pressure_plate` על ה־`original_game`, **אסור** להשתמש ישירות ב־`submit_next_action` ו־`_open_doors` בהרצה האמיתית.
- אם מבצעים סימולציות — השתמשו ב־**deep copy** של המשחק.
- שמרו על ייצוג עקבי של פעולות/מצבים (אותיות גדולות וכו') — הבודק אוטומטי.
- מומלץ לבנות כמה מודלים שונים לבדיקות עצמיות. הנחות סבירות:
  - `finished_reward > max_steps`
  - `opening_door_reward < finished_reward` (מותר אף להיות שלילי)
  - `step_punishment` שלילי ובגודל קטן מ־`finished_reward / max_steps`

---

## 📈 קריטריונים להערכה (תמצית)

- הבודק יריץ **20** בעיות PressurePlate בדרגות קושי שונות ומודלים שונים.
- לכל בעיה יש **מקסימום זמן** (לדוגמה 5 דקות). בעיות שלא מסתיימות נספרות כעמידה במקום עם קנס צעדים.
- הציון נקבע לפי **ממוצע תגמולים** לעומת "מדיניות ממוצעת/על-הקו" (on-par).  
- גודל מפה מקסימלי: **20×20**; עד **10 בלוקי מפתח**.

---

## 🧭 רעיונות למימוש

- **Value Iteration / Policy Iteration** על אבסטרקציה קומפקטית של מצב (מיקום סוכן, דלתות פתוחות, וכו') תוך שימוש בהסתברויות ההחלקה.
- **סימולציות** (על deep copy) לקבלת אומדנים למעברים/תגמולים כאשר קשה לגזור אנליטית.
- **מניעת לולאות** ושבירת שוויון חכמה כדי לצמצם "ריחופים".
- מודעות ל־`max_steps` (למשל, "בונוס קרבה" ליעד או דיסקאונט שמרני).

---

## 🔧 פקודות Git שימושיות

```bash
git add -A
git commit -m "Implement controller and examples"
git push origin main
```

**מחיקת קבצים מה־GitHub בהתאם לשינויים מקומיים:**  
בצעו מחיקות מקומית → `git add -A` → `git commit` → `git push` (ואם צריך: `git push --force`).

---

## 🗂 צ'ק-ליסט להגשה

- [ ] `ex2.py` מממש `Controller.__init__` ו־`Controller.choose_next_action` בדיוק.
- [ ] `details.txt` עם **שם באנגלית** בשורה 1 ו־**ת"ז** בשורה 2.
- [ ] אין קבצים מיותרים בהגשה.
- [ ] נבדק על כמה מודלים, זמן פתרון עומד במגבלות.

---

## 📄 הערת אקדמיות

יש להקפיד על כללי עבודה ומדיניות קורס (שיתוף, ציטוטים וכו'). מצאתם **באג** מהותי ב־`pressure_plate.py` שמוביל לסטייה בתוצאות? מומלץ לדווח למרצה/מתרגלים (ייתכן בונוס — לפי הנהלים).
